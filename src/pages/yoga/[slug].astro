---
import Site from "../../layouts/Site.astro";
import CTAButton from "../../components/CTAButton.astro";
import { yogaPlans } from "../../data/generated";

export async function getStaticPaths() {
    return yogaPlans.map((p) => ({
        params: { slug: p.slug },
        props: { plan: p },
    }));
}

const { plan } = Astro.props;
const canonical = `/yoga/${plan.slug}`;
---

<Site
    title={`${plan.title} · Yoga Plan · Tulaa`}
    description={plan.teaser ||
        plan.subtitle ||
        "Gentle preview of this Tulaa yoga plan."}
    canonicalPath={canonical}
>
    <main class="wrap" style="max-width:940px;margin:0 auto;padding:24px;">
        <a href="/yoga" class="ypd-back">← All Yoga Plans</a>

        <header style="margin-top:12px;">
            <h1 class="ypd-title">{plan.title}</h1>

            {plan.subtitle && <p class="ypd-sub">{plan.subtitle}</p>}
        </header>

        <img
            src={plan.image}
            alt={plan.title}
            width="1200"
            height="630"
            loading="eager"
            style="width:100%;height:auto;border-radius:12px;margin:16px 0;"
        />

        {plan.teaser && <p class="ypd-teaser">{plan.teaser}</p>}

        {
            plan.benefits && (
                <div class="ypd-benefits-box">
                    <strong class="ypd-benefits-title">Benefits</strong>
                    <p class="ypd-benefits-text">{plan.benefits}</p>
                </div>
            )
        }

        <div style="margin-top:18px;display:flex;gap:10px;flex-wrap:wrap;">
            <CTAButton
                href={plan.deeplink}
                label="Open in Tulaa app"
                variant="soft"
                size="md"
            />
            <CTAButton
                href="/yoga"
                label="Browse more plans"
                variant="soft"
                size="md"
            />
        </div>
    </main>
</Site>

<style>
    .ypd-back {
        font-family: var(--font-sans);
        font-size: var(--fs-body);
        color: var(--accent);
        text-decoration: none;
    }
    .ypd-back:hover {
        text-decoration: underline;
    }

    .ypd-title {
        margin: 6px 0 10px;
        font-family: var(--font-sans);
        font-size: var(--fs-h1);
        font-weight: var(--fw-bold);
        color: var(--fg);
    }

    .ypd-sub {
        margin: 0;
        font-family: var(--font-sans);
        font-size: var(--fs-body-lg);
        color: var(--muted);
    }

    .ypd-teaser {
        font-family: var(--font-sans);
        font-size: var(--fs-body-lg);
        line-height: var(--lh-body);
        color: var(--fg);
        margin: 12px 0 18px;
    }

    .ypd-benefits-box {
        padding: 12px;
        border: 1px solid var(--ring);
        border-radius: 12px;
        background: var(--bg-elev);
        margin-top: 10px;
    }

    .ypd-benefits-title {
        font-family: var(--font-sans);
        font-size: var(--fs-body);
        font-weight: var(--fw-semibold);
    }

    .ypd-benefits-text {
        margin: 6px 0 0;
        font-family: var(--font-sans);
        font-size: var(--fs-body);
        color: var(--muted);
        line-height: var(--lh-body);
    }
</style>
