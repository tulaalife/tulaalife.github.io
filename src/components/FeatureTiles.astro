---
// components/FeatureTiles.astro
interface Tile {
    emoji: string;
    title: string;
    subtitle: string;
    href?: string;
}
interface Props {
    title?: string;
    tiles: Tile[];
}

const { title = "More ways Tulaa helps", tiles } = Astro.props;
---

<section class="more" aria-labelledby="more">
    <h2 id="more" class="more__title section-heading">{title}</h2>

    <div class="more__wrap">
        <ul class="more__grid" role="list">
            {
                tiles.map((t) => (
                    <li class="tile">
                        {t.href ? (
                            <a href={t.href} class="tile__link">
                                <div class="tile__emoji" aria-hidden="true">
                                    <span class="badge">{t.emoji}</span>
                                </div>
                                <div class="tile__text">
                                    <div class="tile__title">{t.title}</div>
                                    <div class="tile__sub">{t.subtitle}</div>
                                </div>
                            </a>
                        ) : (
                            <div
                                class="tile__link"
                                role="img"
                                aria-label={`${t.title} — ${t.subtitle}`}
                            >
                                <div class="tile__emoji" aria-hidden="true">
                                    <span class="badge">{t.emoji}</span>
                                </div>
                                <div class="tile__text">
                                    <div class="tile__title">{t.title}</div>
                                    <div class="tile__sub">{t.subtitle}</div>
                                </div>
                            </div>
                        )}
                    </li>
                ))
            }
        </ul>
    </div>
</section>

<style>
    :root {
        --tile-bg: color-mix(in oklab, var(--card) 86%, transparent);
        --tile-border: color-mix(in oklab, var(--ring) 72%, transparent);
        --tile-hover-border: color-mix(in oklab, var(--ring) 55%, var(--fg) 8%);
        --tile-glow: color-mix(in oklab, var(--btn) 20%, transparent);
        --badge-bg: color-mix(in oklab, var(--btn) 22%, var(--card) 78%);
    }

    .more {
        width: 100%;
        margin: 32px 0;
        padding: 0; /* remove inline padding that skews centering */
        text-align: center;
    }

    .more__title {
        margin: 0 0 16px;
    }

    /* The rounded background container */
    .more__wrap {
        width: 100%;
        max-width: none;
        margin: 0;
        /* FIX: Removing the padding from the wrap so the grid can define its own bounds */
        padding: 0;
        border-radius: 24px;
        background: radial-gradient(
                900px 300px at 50% -60px,
                color-mix(in oklab, var(--tile-glow) 18%, transparent),
                transparent 70%
            ),
            color-mix(in oklab, var(--card) 97%, transparent);
        isolation: isolate;
    }

    /* Grid: solid gaps prevent the “divider overlap” look */
    .more__grid {
        list-style: none;
        margin: 0;
        /* FIX: Re-adding the padding here for mobile, but it's relative to the now padding-less .more__wrap */
        padding: clamp(10px, 1.8vw, 20px);
        display: grid;
        grid-template-columns: 1fr;
        gap: clamp(14px, 2.2vw, 24px);
        align-items: stretch;
        justify-items: stretch;
    }

    @media (min-width: 960px) {
        .more__grid {
            grid-template-columns: repeat(2, minmax(320px, 1fr));
            justify-content: center;
        }

        .more__wrap {
            max-width: 1120px;
            margin-inline: auto;
        }
    }

    .tile {
        min-width: 0;
    }

    /* Card */
    .tile__link {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;

        background: linear-gradient(
                180deg,
                color-mix(in oklab, var(--tile-bg) 95%, transparent),
                var(--tile-bg)
            ),
            radial-gradient(
                120% 240% at 10% -40%,
                color-mix(in oklab, var(--btn) 6%, transparent),
                transparent 70%
            );
        border: 1px solid var(--tile-border);
        border-radius: 18px;
        padding: 20px;
        text-decoration: none;
        color: inherit;
        box-shadow: 0 1px 0 rgba(0, 0, 0, 0.04) inset;
        transition:
            transform 140ms ease,
            box-shadow 140ms ease,
            border-color 140ms ease,
            background 200ms ease;
        -webkit-tap-highlight-color: transparent;
    }

    /* Remove margin hacks: prevents “overlap/ghost line” on hover */
    .tile__link:hover {
        transform: translateY(-2px);
        border-color: var(--tile-hover-border);
        box-shadow:
            0 12px 28px rgba(0, 0, 0, 0.07),
            0 1px 0 rgba(255, 255, 255, 0.08) inset;
    }

    .tile__link:active {
        transform: translateY(0);
        box-shadow: 0 4px 14px rgba(0, 0, 0, 0.06);
    }

    .tile__link:focus-visible {
        outline: none;
        border-color: color-mix(
            in oklab,
            var(--btn) 50%,
            var(--tile-hover-border)
        );
        box-shadow: 0 0 0 3px color-mix(in oklab, var(--btn) 30%, transparent);
    }

    /* Badge */
    .badge {
        display: grid;
        place-items: center;
        width: 44px;
        height: 44px;
        border-radius: 12px;
        background: linear-gradient(
            180deg,
            color-mix(in oklab, var(--badge-bg) 80%, transparent),
            var(--badge-bg)
        );
        border: 1px solid color-mix(in oklab, var(--ring) 65%, transparent);
        box-shadow:
            0 6px 18px rgba(0, 0, 0, 0.06),
            0 1px 0 rgba(255, 255, 255, 0.25) inset;
        font-size: 22px;
        line-height: 1;
        margin-bottom: 10px;
    }

    .tile__title {
    }
    .tile__sub {
        margin-top: 6px;
    }

    .tile__emoji {
        display: contents;
    } /* keeps markup simple + centered */
    .tile__chev {
        display: none;
    }
</style>
