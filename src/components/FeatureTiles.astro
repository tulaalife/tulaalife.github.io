---
// components/FeatureTiles.astro
interface Tile {
    emoji: string;
    title: string;
    subtitle: string;
    href?: string;
}

interface Props {
    title?: string;
    tiles: Tile[];
}

const { tiles } = Astro.props;
---

<section class="more-section" aria-label="Features">
    <div class="more__grid" role="list">
        {
            tiles.map((t) => {
                const Tag = t.href ? "a" : "div";
                const isLink = !!t.href;

                return (
                    <div class="tile-wrapper" role="listitem">
                        <Tag
                            href={t.href}
                            class:list={[
                                "tile",
                                { "tile--interactive": isLink },
                            ]}
                            aria-label={
                                isLink
                                    ? undefined
                                    : `${t.title} â€” ${t.subtitle}`
                            }
                        >
                            <div class="tile__icon-box">
                                <span class="tile__emoji">{t.emoji}</span>
                            </div>

                            <div class="tile__content">
                                <h3 class="tile__title">{t.title}</h3>
                                <p class="tile__desc">{t.subtitle}</p>
                            </div>

                            {isLink && (
                                <div class="tile__action" aria-hidden="true">
                                    <svg
                                        width="12"
                                        height="12"
                                        viewBox="0 0 12 12"
                                        fill="none"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path
                                            d="M1 11L11 1M11 1H3.5M11 1V8.5"
                                            stroke="currentColor"
                                            stroke-width="2"
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                        />
                                    </svg>
                                </div>
                            )}
                        </Tag>
                    </div>
                );
            })
        }
    </div>
</section>

<style>
    /* * Design Tokens 
   * Using generic fallbacks if your global vars (--card, --fg, etc.) aren't present
   */
    .more-section {
        --tile-bg: var(--card, #ffffff);
        --tile-fg: var(--fg, #1a1a1a);
        --tile-muted: var(--muted, #666666);
        --tile-border: var(--ring, rgba(0, 0, 0, 0.1));
        --tile-radius: 20px;

        /* Animation curve for a premium "snappy" feel */
        --ease-spring: cubic-bezier(0.25, 0.8, 0.25, 1);

        width: 100%;
        margin: 0 auto;
    }

    .more__grid {
        display: grid;
        /* Smart responsive grid: scales from 1 column to 2 automatically */
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 16px;
        padding: 0;
        list-style: none;
    }

    /* --- The Card --- */
    .tile {
        position: relative;
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px;
        background: linear-gradient(
            180deg,
            color-mix(in srgb, var(--tile-bg), transparent 20%),
            var(--tile-bg)
        );
        /* Premium Border Trick: Box shadow inset acts as a cleaner inner border */
        box-shadow:
            inset 0 0 0 1px
                color-mix(in srgb, var(--tile-border), transparent 60%),
            0 2px 4px rgba(0, 0, 0, 0.02),
            0 8px 16px rgba(0, 0, 0, 0.02);
        border-radius: var(--tile-radius);
        text-decoration: none;
        color: inherit;
        transition: all 0.3s var(--ease-spring);
        overflow: hidden;
    }

    /* Interactive State (Links only) */
    .tile--interactive {
        cursor: pointer;
    }

    .tile--interactive:hover {
        transform: translateY(-2px);
        background: var(--tile-bg);
        box-shadow:
            inset 0 0 0 1px
                color-mix(in srgb, var(--tile-border), transparent 30%),
            0 12px 24px rgba(0, 0, 0, 0.06),
            0 4px 8px rgba(0, 0, 0, 0.03);
    }

    .tile--interactive:active {
        transform: scale(0.98);
        transition-duration: 0.1s;
    }

    .tile--interactive:focus-visible {
        outline: none;
        box-shadow:
            inset 0 0 0 2px var(--tile-fg),
            0 8px 20px rgba(0, 0, 0, 0.1);
    }

    /* --- Icon Box --- */
    .tile__icon-box {
        flex-shrink: 0;
        display: grid;
        place-items: center;
        width: 48px;
        height: 48px;
        background: color-mix(in srgb, var(--tile-fg), transparent 96%);
        border-radius: 14px;
        border: 1px solid
            color-mix(in srgb, var(--tile-border), transparent 80%);
        font-size: 24px;
        line-height: 1;
        /* Subtle depth for the badge */
        box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.6);
    }

    /* --- Typography --- */
    .tile__content {
        flex: 1;
        min-width: 0; /* Prevents flex blowout */
    }

    .tile__title {
        margin: 0 0 4px;
        font-size: 1rem;
        font-weight: 600;
        color: var(--tile-fg);
        letter-spacing: -0.01em;
        /* Prevents single words hanging on a new line */
        text-wrap: balance;
    }

    .tile__desc {
        margin: 0;
        font-size: 0.875rem;
        color: var(--tile-muted);
        line-height: 1.4;

        /* Truncate after 2 lines if text is too long */
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    /* --- Action Arrow --- */
    .tile__action {
        flex-shrink: 0;
        display: grid;
        place-items: center;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        color: var(--tile-muted);
        opacity: 0.6;
        background: color-mix(in srgb, var(--tile-fg), transparent 96%);
        transition:
            transform 0.3s var(--ease-spring),
            color 0.3s ease;
    }

    /* Hover Animations */
    .tile--interactive:hover .tile__action {
        opacity: 1;
        color: var(--tile-fg);
        transform: translate(2px, -2px);
        background: color-mix(in srgb, var(--tile-fg), transparent 92%);
    }

    /* --- Responsive Polish --- */
    @media (max-width: 640px) {
        .tile {
            padding: 14px;
            gap: 12px;
            border-radius: 16px;
        }

        .tile__icon-box {
            width: 42px;
            height: 42px;
            font-size: 20px;
        }

        .tile__title {
            font-size: 0.95rem;
        }

        .tile__action {
            /* Hide the arrow circle on small screens to save space, 
         or make it smaller. Here we make it transparent but present. */
            background: transparent;
            width: auto;
            height: auto;
        }
    }
</style>
