---
// components/FeatureTiles.astro
interface Tile {
    emoji: string;
    title: string;
    subtitle: string;
    href?: string;
}
interface Props {
    title?: string;
    tiles: Tile[];
}

const { title = "More ways Tulaa helps", tiles } = Astro.props;
---

<section
    class:list={["more", "home-block", "home-block--soft"]}
    aria-labelledby="more"
>
    <h2 id="more" class="more__title section-heading">{title}</h2>

    <div class="more__wrap">
        <ul class="more__grid" role="list">
            {
                tiles.map((t) => (
                    <li class="tile">
                        {t.href ? (
                            <a href={t.href} class="tile__link">
                                <div class="tile__emoji" aria-hidden="true">
                                    <span class="badge">{t.emoji}</span>
                                </div>
                                <div class="tile__text">
                                    <div class="tile__title">{t.title}</div>
                                    <div class="tile__sub">{t.subtitle}</div>
                                </div>
                                <div class="tile__chev" aria-hidden="true">
                                    ↗
                                </div>
                            </a>
                        ) : (
                            <div
                                class="tile__link tile__link--static"
                                role="img"
                                aria-label={`${t.title} — ${t.subtitle}`}
                            >
                                <div class="tile__emoji" aria-hidden="true">
                                    <span class="badge">{t.emoji}</span>
                                </div>
                                <div class="tile__text">
                                    <div class="tile__title">{t.title}</div>
                                    <div class="tile__sub">{t.subtitle}</div>
                                </div>
                            </div>
                        )}
                    </li>
                ))
            }
        </ul>
    </div>
</section>

<style>
    .more {
        /* Scope tile vars to this block */
        --tile-bg: color-mix(in oklab, var(--card) 90%, transparent);
        --tile-border: color-mix(in oklab, var(--ring) 70%, transparent);
        --tile-hover-border: color-mix(in oklab, var(--ring) 55%, var(--fg) 8%);
        --badge-bg: color-mix(in oklab, var(--fg) 4%, var(--card) 96%);

        width: 100%;
        margin: 0; /* spacing handled by .home gap */
        padding: 0;
        text-align: center;
    }

    .more__title {
        margin: 0 0 12px;
    }

    /* Outer wrap just constrains width */
    .more__wrap {
        width: 100%;
    }

    .more__grid {
        list-style: none;
        margin: 0 auto;
        padding: 0;
        max-width: 100%; /* let main/container control actual width */
        display: grid;
        grid-template-columns: 1fr;
        gap: 12px;
        align-items: stretch;
        justify-items: stretch;
    }

    @media (min-width: 960px) {
        .more__grid {
            /* no extra max-width needed */
            grid-template-columns: repeat(2, minmax(320px, 1fr));
            gap: 14px;
        }
    }

    .tile {
        min-width: 0;
    }

    /* Card: slimmer, lighter, left-aligned */
    .tile__link {
        display: flex;
        align-items: center;
        gap: 12px;
        text-align: left;

        background: linear-gradient(
            180deg,
            color-mix(in oklab, var(--tile-bg) 96%, transparent),
            var(--tile-bg)
        );
        border: 1px solid var(--tile-border);
        border-radius: 18px;
        padding: 12px 14px;
        text-decoration: none;
        color: inherit;
        box-shadow:
            0 1px 0 rgba(255, 255, 255, 0.5) inset,
            0 6px 16px rgba(0, 0, 0, 0.04);
        transition:
            transform 120ms ease,
            box-shadow 120ms ease,
            border-color 120ms ease,
            background 180ms ease,
            translate 120ms ease;
        -webkit-tap-highlight-color: transparent;
    }

    .tile__link:hover {
        transform: translateY(-1px);
        border-color: var(--tile-hover-border);
        box-shadow:
            0 10px 24px rgba(0, 0, 0, 0.08),
            0 1px 0 rgba(255, 255, 255, 0.55) inset;
        background: linear-gradient(
            180deg,
            color-mix(in oklab, var(--tile-bg) 98%, transparent),
            var(--tile-bg)
        );
    }

    .tile__link:active {
        transform: translateY(0);
        box-shadow:
            0 4px 12px rgba(0, 0, 0, 0.06),
            0 1px 0 rgba(255, 255, 255, 0.5) inset;
    }

    .tile__link:focus-visible {
        outline: none;
        border-color: color-mix(
            in oklab,
            var(--btn) 50%,
            var(--tile-hover-border)
        );
        box-shadow:
            0 0 0 2px color-mix(in oklab, var(--btn) 26%, transparent),
            0 10px 24px rgba(0, 0, 0, 0.08);
    }

    /* Non-link version: no chevron + very light hover */
    .tile__link--static {
        cursor: default;
    }
    .tile__link--static:hover {
        transform: none;
        box-shadow:
            0 6px 18px rgba(0, 0, 0, 0.04),
            0 1px 0 rgba(255, 255, 255, 0.5) inset;
    }

    /* Emoji badge */
    .tile__emoji {
        flex: 0 0 auto;
    }

    .badge {
        display: grid;
        place-items: center;
        width: 44px;
        height: 44px;
        border-radius: 14px;
        background: radial-gradient(
            120% 140% at 30% 0%,
            color-mix(in oklab, #ffffff 16%, var(--badge-bg)),
            var(--badge-bg)
        );
        border: 1px solid color-mix(in oklab, var(--ring) 60%, transparent);
        box-shadow:
            0 7px 18px rgba(0, 0, 0, 0.06),
            0 1px 0 rgba(255, 255, 255, 0.35) inset;
        font-size: 24px;
        line-height: 1;
    }

    /* Text block */
    .tile__text {
        flex: 1;
        min-width: 0;
    }

    .tile__title {
        font-size: var(--fs-body, 0.98rem);
        font-weight: var(--fw-semibold);
        letter-spacing: 0.01em;
        color: var(--fg);
        margin: 0 0 2px;
    }

    .tile__sub {
        margin: 0;
        font-size: var(--fs-body-sm);
        line-height: var(--lh-body);
        color: var(--muted);
    }

    /* Chevron */
    .tile__chev {
        flex: 0 0 auto;
        width: 26px;
        height: 26px;
        border-radius: 999px;
        display: grid;
        place-items: center;
        font-size: 13px;
        color: color-mix(in oklab, var(--fg) 70%, var(--muted) 30%);
        background: color-mix(in oklab, var(--card) 96%, transparent);
        border: 1px solid color-mix(in oklab, var(--ring) 65%, transparent);
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.04);
        translate: 0 0;
        transition:
            translate 120ms ease,
            box-shadow 120ms ease;
    }

    .tile__link:hover .tile__chev {
        translate: 1px 0;
        box-shadow: 0 5px 12px rgba(0, 0, 0, 0.08);
    }

    .tile__link--static .tile__chev {
        display: none;
    }

    @media (max-width: 520px) {
        .tile__link {
            align-items: flex-start;
            padding: 12px 12px;
        }
        .badge {
            width: 42px;
            height: 42px;
            font-size: 22px;
        }
    }
</style>
